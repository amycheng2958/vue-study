<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>
<body>
    <script>
        const obj = {
            name: "cyy",
            foo: {
                bar: 1
            },
            arr: [1]
        };
        function defineReactive(obj,key,val) {
            observe(val)
            Object.defineProperty(obj,key,{
                set(newval) {
                    if (newval !== val) {
                        console.log('set'+key+newval)
                        observe(newval)
                        val = newval
                    }
                },
                get() {
                    console.log('get'+key+ JSON.stringify(val))
                    return val
                }
            })
        }
        // defineReactive(obj,'name',obj['name'])
        function observe(obj) {
            if (typeof obj !== 'object' || obj === null) {
                return 
            }
            Object.keys(obj).forEach((key)=>{
                defineReactive(obj,key,obj[key])
            })
        }
        function set (obj,key,val) {
            defineReactive(obj,key,val)
        }
        observe(obj)
        obj.name
        obj.name = 'cyy01'
        obj.foo.bar
        obj.foo = {
            bar: 1000
        }
        obj.foo.bar
        set(obj,'dong','dong')
        obj.dong = '1'
        obj.dong
        // obj.arr.push(4)
        // obj.arr
    </script>
</body>
</html>